<div id="silly-sim-tracker-settings">
  <div class="inline-drawer">
    <div class="inline-drawer-toggle inline-drawer-header">
      <b>Silly Sim Tracker</b>
      <div
        class="inline-drawer-icon fa-solid fa-circle-chevron-down down"
      ></div>
    </div>
    <div class="inline-drawer-content">
      <div class="silly-sim-tracker-settings-content">
        <div class="setting">
          <label for="isEnabled">Enable Tracker</label>
          <div class="control"><input type="checkbox" id="isEnabled" /></div>
        </div>
        <p class="description">
          The master switch to enable or disable the extension.
        </p>
        <hr />
        <div class="setting">
          <label for="codeBlockIdentifier">Code Block Identifier</label>
          <div class="control">
            <input type="text" id="codeBlockIdentifier" class="text_pole" />
          </div>
        </div>
        <p class="description">
          The keyword the extension looks for after the opening ``` (e.g.,
          "sim").
        </p>
        <hr />
        <div class="setting">
          <label for="defaultBgColor">Default Card Color</label>
          <div class="control"><input type="color" id="defaultBgColor" /></div>
        </div>
        <p class="description">
          The background color used for cards when one isn't specified in the
          JSON.
        </p>
        <hr />
        <div class="setting">
          <label for="showThoughtBubble">Show Thought Bubble</label>
          <div class="control">
            <input type="checkbox" id="showThoughtBubble" />
          </div>
        </div>
        <p class="description">
          Whether to display the 'thought' section at the bottom of the card.
        </p>
        <hr />

        <div class="setting">
          <label for="templateFile">Default Template</label>
          <select id="templateFile" class="text_pole"></select>
        </div>
        <div class="description">
          Select a built-in template. This is used when no custom template is
          loaded.
        </div>

        <div class="setting">
          <label>Custom Template</label>
          <div class="flex-container">
            <button
              id="uploadCustomTemplateBtn"
              class="menu_button"
              title="Load a .html file from your computer to use as a custom template."
            >
              Load from File
            </button>
            <button
              id="clearCustomTemplateBtn"
              class="menu_button"
              title="Clear the loaded custom template and revert to using the selected default template."
            >
              Clear Custom
            </button>
          </div>
        </div>
        <!-- This hidden input is used to open the file dialog -->
        <input type="file" id="customTemplateUpload" hidden accept=".html" />

        <p class="description">
          Path to the HTML template file relative to tracker-card-templates/
          directory. Default: default-card-template.html
        </p>
        <hr />
        
        <!-- Custom Fields Section -->
        <h4>Custom Sim Data Fields</h4>
        <div class="setting">
            <label>Define the data fields for your sim tracker.</label>
            <div id="customFieldsList">
                <!-- Fields will be populated here by JavaScript -->
            </div>
            <button id="addCustomFieldBtn" class="menu_button">Add Field</button>
        </div>
        <p class="description">
          These fields define the structure of your sim data and are used by the <code>{{sim_format}}</code> macro in prompts.
        </p>
        <hr />
        
        <div class="setting">
          <label for="datingSimPrompt">Sim Tracker System Prompt</label>
          <textarea id="datingSimPrompt" class="text_pole" rows="6"></textarea>
        </div>
        <p class="description">
          The base prompt to be injected when you use the {{sim_tracker}} macro.
        </p>
      </div>
    </div>
  </div>
</div>

<!-- Template for a single custom field row (hidden by default) -->
<div id="customFieldTemplate" class="setting flex-container hidden" style="gap: 10px; align-items: center; margin-bottom: 8px;">
    <input type="text" class="field-key text_pole" placeholder="Field Key" style="flex: 1; min-width: 100px;" />
    <input type="text" class="field-description text_pole" placeholder="Description" style="flex: 2; min-width: 150px;" />
    <button class="remove-field-btn menu_button">Remove</button>
</div>
